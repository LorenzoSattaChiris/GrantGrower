<%- include('partials/header', {
    title: 'GrantGrower - Available Grants',
    metaDescription: 'Explore available grants tailored to your farm and get support with applications.',
    css: 'grants.css'
}) %>

<main class="grants-page">
    <div class="header">
        <h1>Available Grants</h1>
        <p>Find the grants that suit your farm and apply with ease.</p>
    </div>

    <!-- Search and Filter Section -->
    <section class="search-filter-section">
        <input type="text" id="searchBar" placeholder="Search grants..." />
        <select id="categoryFilter">
            <option value="All">All Categories</option>
            <!-- Categories will be populated dynamically -->
        </select>
    </section>

    <!-- Grant List Section -->
    <section id="grants-list">
        <div class="grant-categories" id="grantCategories"></div>
    </section>

    <% if (existingData) { %>
        <div class="existing-data-collapsible">
            <div class="collapsible-header">
                <span>Your Data</span>
                <i class="tooltip-icon" data-tooltip="Expand or collapse your data">&#9432;</i> <!-- Info Icon -->
            </div>
            <div class="collapsible-content">
                <p><strong>Farm Size:</strong> <%= existingData.farmSize %> acres</p>
                <p><strong>Location:</strong> <%= existingData.location %></p>
                <p><strong>Crop/Livestock Type:</strong> <%= existingData.cropType %></p>
                <p><strong>Years Farming:</strong> <%= existingData.yearsFarming %></p>
                <p><strong>Water Access:</strong> <%= existingData.waterAccess %></p>
                <p><strong>Grant Interest:</strong> <%= existingData.grantInterest %></p>
                <button id="editData" class="btn primary-btn">Edit Data</button>
            </div>
        </div>
    <% } %>    

        <% if (existingData) { %>
            <script>
                document.addEventListener('DOMContentLoaded', () => {
                    document.getElementById('editData').addEventListener('click', () => {
                        window.location.href = '/questions';
                    });

                    const collapsibleHeader = document.querySelector('.collapsible-header');
                    const collapsibleContent = document.querySelector('.collapsible-content');
                
                    collapsibleHeader.addEventListener('click', () => {
                        const isOpen = collapsibleContent.classList.contains('open');
                
                        if (isOpen) {
                            collapsibleContent.classList.remove('open');
                        } else {
                            collapsibleContent.classList.add('open');
                        }
                    });
                });
            </script>
            <% } %>

    <!-- Email Notification Section -->
    <section class="notification-section">
        <h2 class="section-title">Stay Updated</h2>
        <p>Enter your email to get notified about new grants.</p>
        <form id="notification-form">
            <input type="email" id="email" placeholder="Your Email" required />
            <button type="submit" class="btn primary-btn">Subscribe</button>
        </form>
    </section>

    <!-- Support Section -->
    <section class="support-section">
        <h2 class="section-title">Need Help?</h2>
        <p>We provide 24/7 dedicated grant assistance. Reach out to us anytime!</p>
        <div class="support-buttons">
            <button onclick="openChat()" class="btn chat-btn">Chat with Support</button>
            <button onclick="callSupport()" class="btn call-btn">Call Support</button>
        </div>
    </section>
</main>

<script type="text/javascript" src="grants.js"></script>

</body>
</html>
